
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-7.3.6">
    
    
      
        <title>Scripting - Imposter Mocks</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.a57b2b03.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.3f5d1f46.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#scripted-responses" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Imposter Mocks" class="md-header__button md-logo" aria-label="Imposter Mocks" data-md-component="logo">
      
  <img src="../images/plain_logo14.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Imposter Mocks
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Scripting
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Imposter Mocks" class="md-nav__button md-logo" aria-label="Imposter Mocks" data-md-component="logo">
      
  <img src="../images/plain_logo14.png" alt="logo">

    </a>
    Imposter Mocks
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="https://www.imposter.sh" class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../getting_started/" class="md-nav__link">
        Getting started
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        Configuration guide
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Scripting
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Scripting
      </a>
      
        


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
    <nav class="md-nav" aria-label="Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#another-example" class="md-nav__link">
    Another example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#script-objects" class="md-nav__link">
    Script objects
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#context-object" class="md-nav__link">
    Context object
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#request-object" class="md-nav__link">
    Request object
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#response-object" class="md-nav__link">
    Response object
  </a>
  
    <nav class="md-nav" aria-label="Response object">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#returning-data-from-a-script" class="md-nav__link">
    Returning data from a script
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-response-headers" class="md-nav__link">
    Setting response headers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returning-raw-data" class="md-nav__link">
    Returning raw data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returning-a-specific-example" class="md-nav__link">
    Returning a specific example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../security/" class="md-nav__link">
        Security
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      
      
      
        <label class="md-nav__link" for="__nav_7">
          Plugins
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Plugins" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Plugins
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../openapi_plugin/" class="md-nav__link">
        OpenAPI (and Swagger) plugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../rest_plugin/" class="md-nav__link">
        REST plugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hbase_plugin/" class="md-nav__link">
        HBase plugin
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../sfdc_plugin/" class="md-nav__link">
        SFDC (Salesforce) plugin
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      
      
      
        <label class="md-nav__link" for="__nav_8">
          Data capture, storage and templates
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Data capture, storage and templates" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Data capture, storage and templates
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../data_capture/" class="md-nav__link">
        Data capture
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../templates/" class="md-nav__link">
        Response templates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../stores/" class="md-nav__link">
        Stores
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_9" type="checkbox" id="__nav_9" >
      
      
      
      
        <label class="md-nav__link" for="__nav_9">
          Advanced
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Advanced" data-md-level="1">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          Advanced
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../usage/" class="md-nav__link">
        Usage (arguments and environment variables)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../request_matching/" class="md-nav__link">
        Advanced request matching
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../openapi_validation/" class="md-nav__link">
        OpenAPI validation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../performance_simulation/" class="md-nav__link">
        Performance simulation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../metrics_logs_telemetry/" class="md-nav__link">
        Metrics, logs and telemetry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../performance_tuning/" class="md-nav__link">
        Performance tuning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tls_ssl/" class="md-nav__link">
        TLS/SSL
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_10" type="checkbox" id="__nav_10" >
      
      
      
      
        <label class="md-nav__link" for="__nav_10">
          Other
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Other" data-md-level="1">
        <label class="md-nav__title" for="__nav_10">
          <span class="md-nav__icon md-icon"></span>
          Other
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../tips_tricks/" class="md-nav__link">
        Tips and tricks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../benchmarks/" class="md-nav__link">
        Benchmarks
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_11" type="checkbox" id="__nav_11" >
      
      
      
      
        <label class="md-nav__link" for="__nav_11">
          Developers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Developers" data-md-level="1">
        <label class="md-nav__title" for="__nav_11">
          <span class="md-nav__icon md-icon"></span>
          Developers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://github.com/outofcoffee/imposter" class="md-nav__link">
        GitHub
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../build/" class="md-nav__link">
        Build
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../roadmap/" class="md-nav__link">
        Roadmap
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_12" type="checkbox" id="__nav_12" >
      
      
      
      
        <label class="md-nav__link" for="__nav_12">
          Tutorials
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tutorials" data-md-level="1">
        <label class="md-nav__title" for="__nav_12">
          <span class="md-nav__icon md-icon"></span>
          Tutorials
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://medium.com/@outofcoffee/mocking-apis-with-swagger-and-imposter-3694bd1733c0" class="md-nav__link">
        Mocking APIs with Swagger and Imposter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://medium.com/@outofcoffee/mocking-apis-with-imposter-53bd908632e5" class="md-nav__link">
        Mocking REST APIs with Imposter
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
    <nav class="md-nav" aria-label="Example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#another-example" class="md-nav__link">
    Another example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#script-objects" class="md-nav__link">
    Script objects
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#context-object" class="md-nav__link">
    Context object
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#request-object" class="md-nav__link">
    Request object
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#response-object" class="md-nav__link">
    Response object
  </a>
  
    <nav class="md-nav" aria-label="Response object">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#returning-data-from-a-script" class="md-nav__link">
    Returning data from a script
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setting-response-headers" class="md-nav__link">
    Setting response headers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returning-raw-data" class="md-nav__link">
    Returning raw data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#returning-a-specific-example" class="md-nav__link">
    Returning a specific example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="scripted-responses">Scripted responses</h1>
<p>Read this section to learn how to use scripts to configure Imposter's responses.</p>
<p>You can control Imposter's responses using JavaScript or Groovy scripts. (If you choose <a href="http://www.groovy-lang.org/">Groovy</a>, you can of course write plain Java in your scripts as well).</p>
<h2 id="example">Example</h2>
<p>Here's an example configuration file that uses a script:</p>
<pre><code class="language-yaml"># scripted-example-config.yaml
---
plugin: rest
path: &quot;/example-two&quot;
response:
  scriptFile: example.groovy
</code></pre>
<p>...and here's the corresponding script (<code>example.groovy</code>):</p>
<pre><code class="language-groovy">if (context.request.queryParams.action == 'create') {
    respond()
        .withStatusCode(201)
        .skipDefaultBehaviour()
}
</code></pre>
<p>We will explain this syntax later, in the <em>ResponseBehaviour object</em> section. For now, it's enough to know that the example above causes the mock server to respond with HTTP status code 201 if the value of the <code>action</code> parameter in the request is <code>create</code>.</p>
<p>For example:</p>
<pre><code>HTTP GET http://localhost:8080/example-two?action=create
...
201 Created
</code></pre>
<p><em>Tip:</em> The <code>queryParams</code> object used in the script is just a map of the request parameters, so you can use either <code>params.yourParamName</code> or <code>params['yourParamName']</code> syntax to access its members.</p>
<h3 id="another-example">Another example</h3>
<p>Here's a more sophisticated example script:</p>
<pre><code class="language-groovy">switch (context.request.queryParams.action) {
    case 'create':
        // HTTP Status-Code 201: Created.
        respond()
            .withStatusCode(201)
            .skipDefaultBehaviour()
        break

    case 'fetch':
        // use a static response file and the default plugin behaviour
        respond()
            .withFile('example-data.json')
            .usingDefaultBehaviour()
        break

    default:
        // default to bad request
        respond()
            .withStatusCode(400)
            .skipDefaultBehaviour()
        break
}
</code></pre>
<p>In this example, the script causes the mock server to respond with HTTP status codes 200, 201 or 400 depending on the value of the <code>action</code> parameter in the request.</p>
<p>For example:</p>
<pre><code>HTTP GET http://localhost:8080/example-two?action=fetch
...
HTTP/1.1 200 OK
...
{
  "hello": "world"
}
</code></pre>
<p>In the case of <code>action=fetch</code>, the script causes the mock server to use the content of the static file
<code>static-data.json</code> to serve the response.</p>
<p>And:</p>
<pre><code>HTTP GET http://localhost:8080/example-two?action=foo
...
400 Bad Request
</code></pre>
<p>In the default case, the script causes the mock server to return an HTTP 400 response, as shown above.</p>
<p>There are many other script objects you could use in order to decide what to return. For example, your script might use the request method (GET, POST, PUT, DELETE etc.) or other request attributes.</p>
<h2 id="script-objects">Script objects</h2>
<p>In order to help you determine what action to take, Imposter makes certain objects available to your scripts.</p>
<table>
<thead>
<tr>
<th>Object</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>context</code></td>
<td>Parent object for accessing request properties</td>
</tr>
<tr>
<td><code>config</code></td>
<td>The plugin configuration for the current request</td>
</tr>
<tr>
<td><code>env</code></td>
<td>A map of environment variables, such as <code>{ "MY_VAR": "abc", "VAR2": "def" }</code></td>
</tr>
<tr>
<td><code>logger</code></td>
<td>Logger, supporting levels such as <code>info(String)</code>, <code>warn(String)</code> etc.</td>
</tr>
</tbody>
</table>
<h2 id="context-object">Context object</h2>
<p>The <code>context</code> object is available to your scripts. It holds things you might like to interrogate, like the request object.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>request</code></td>
<td>The HTTP request.</td>
<td><em>See Request object.</em></td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> Certain plugins will add additional properties to the <code>context</code>. For example, the <em>hbase</em>
plugin provides a <code>tableName</code> object, which you can use to determine the HBase table for the request being served.</p>
<h2 id="request-object">Request object</h2>
<p>The request object is available on the <code>context</code>. It provides access to request parameters, method, URI etc.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>path</code></td>
<td>The path of the request.</td>
<td><code>"/example"</code></td>
</tr>
<tr>
<td><code>method</code></td>
<td>The HTTP method of the request.</td>
<td><code>"GET"</code></td>
</tr>
<tr>
<td><code>pathParams</code></td>
<td>A map containing the request path parameters.</td>
<td><code>{ "productCode": "abc", "foo": "bar" }</code></td>
</tr>
<tr>
<td><code>queryParams</code></td>
<td>A map containing the request query parameters.</td>
<td><code>{ "limit": "10", "foo": "bar" }</code></td>
</tr>
<tr>
<td><code>uri</code></td>
<td>The absolute URI of the request.</td>
<td><code>"http://example.com?foo=bar&amp;baz=qux"</code></td>
</tr>
<tr>
<td><code>headers</code></td>
<td>A map containing the request headers.</td>
<td><code>{ "X-Example": "ABC123", "Content-Type": "text/plain" }</code></td>
</tr>
<tr>
<td><code>normalisedHeaders</code></td>
<td>A map containing the request headers with all keys in lowercase.</td>
<td><code>{ "x-example": "ABC123", "content-type": "text/plain" }</code></td>
</tr>
<tr>
<td><code>body</code></td>
<td>A string containing the request body.</td>
<td><code>"Hello world."</code></td>
</tr>
</tbody>
</table>
<blockquote>
<p>Note: keys are always lowercase in <code>normalisedHeaders</code>, regardless of the request header casing. This aids script portability, avoiding case-sensitivity for header keys.</p>
</blockquote>
<h2 id="response-object">Response object</h2>
<p>Your scripts have access to the methods on <code>io.gatehill.imposter.script.MutableResponseBehaviour</code>.</p>
<p>The response behaviour object provides a number of methods to enable you to control the response:</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Plugin(s)</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>withStatusCode(int)</code></td>
<td>all</td>
<td>Set the HTTP status code for the response.</td>
</tr>
<tr>
<td><code>withFile(String)</code></td>
<td>all</td>
<td>Respond with the content of a static file. Also see <code>template</code>.</td>
</tr>
<tr>
<td><code>withData(String)</code></td>
<td>all</td>
<td>Respond with the literal content of a string. Also see <code>template</code>.</td>
</tr>
<tr>
<td><code>withExampleName(String)</code></td>
<td>openapi</td>
<td>Respond with the OpenAPI specification example with a given name.</td>
</tr>
<tr>
<td><code>withHeader(String, String)</code></td>
<td>all</td>
<td>Set a response header.</td>
</tr>
<tr>
<td><code>withEmpty()</code></td>
<td>all</td>
<td>Respond with empty content, or no records.</td>
</tr>
<tr>
<td><code>usingDefaultBehaviour()</code></td>
<td>all</td>
<td>Use the plugin's default behaviour to respond.</td>
</tr>
<tr>
<td><code>skipDefaultBehaviour()</code></td>
<td>all</td>
<td>Skip the plugin's default behaviour when responding.</td>
</tr>
<tr>
<td><code>and()</code></td>
<td>all</td>
<td>Syntactic sugar to improve readability of <code>respond</code> statements.</td>
</tr>
<tr>
<td><code>template()</code></td>
<td>all</td>
<td>Treat the response file or data as a <a href="../templates/">template</a> with placeholders.</td>
</tr>
</tbody>
</table>
<p>You structure your response behaviours like so:</p>
<pre><code class="language-groovy">respond() // ... behaviours go here
</code></pre>
<p>For example:</p>
<pre><code class="language-groovy">respond()
    .withStatusCode(201)
    .skipDefaultBehaviour()
</code></pre>
<p>Or:</p>
<pre><code class="language-groovy">respond()
    .withFile('static-data.json')
    .usingDefaultBehaviour()
</code></pre>
<h3 id="returning-data-from-a-script">Returning data from a script</h3>
<p>As we have seen above, to return data when using a script, you specify a response file.</p>
<p>More specifically, to specify which response file to use, you can either:</p>
<ol>
<li>set the <code>staticFile</code> property within the <code>response</code> object in your configuration, which will be treated as the default, or</li>
<li>explicitly call the <code>withFile(String)</code> method in your script.</li>
</ol>
<p>Here's an example of the static file approach:</p>
<pre><code class="language-yaml"># file-example-config.yaml
---
plugin: rest
path: &quot;/scripted&quot;
contentType: application/json
response:
  scriptFile: example.groovy
  staticFile: example-data.json
</code></pre>
<p>Here, the response file <code>example-data.json</code> will be used, unless the script invokes the
<code>withFile(String)</code> method with a different filename.</p>
<p>In order for the mock server to return the response file in an appropriate format, the plugin must be allowed to process it. That means you should not call <code>skipDefaultBehaviour()</code> unless you want to skip using a response file (e.g. if you want to send an error code back or a response without a body).</p>
<p>Whilst not required, your script could invoke <code>usingDefaultBehaviour()</code> for readability to indicate that you want the plugin to handle the response file for you. See the <em>rest</em> plugin tests for a working example. To this end, the following blocks are semantically identical:</p>
<pre><code class="language-groovy">respond()
    .withFile('static-data.json')
    .usingDefaultBehaviour()
</code></pre>
<p>and:</p>
<pre><code class="language-groovy">respond().withFile('static-data.json')
</code></pre>
<h3 id="setting-response-headers">Setting response headers</h3>
<p>You can set response headers using the <code>withHeader(String, String)</code> method. </p>
<pre><code class="language-groovy">respond().withHeader('X-Custom-Header', 'example value')
</code></pre>
<h3 id="returning-raw-data">Returning raw data</h3>
<p>You can return raw data using the <code>withData(String)</code> method.</p>
<pre><code class="language-groovy">respond().withData('{ &quot;someKey&quot;: &quot;someValue&quot; }')
</code></pre>
<h3 id="returning-a-specific-example">Returning a specific example</h3>
<p>When using the <a href="../openapi_plugin/">OpenAPI plugin</a>, you can return a specific named example from the specification using the <code>withExampleName(String)</code> method.</p>
<pre><code class="language-groovy">respond().withExampleName('example1')
</code></pre>
<p>This selects the example from the OpenAPI <code>examples</code> section for the API response.</p>
<hr />
<p><strong>Tip for Groovy users</strong></p>
<p>Groovy users can also use this special block syntax, for improved readability:</p>
<pre><code class="language-groovy">respond {
    // behaviours go here
}
</code></pre>
<p>For example:</p>
<pre><code class="language-groovy">respond {
    withStatusCode 201
    and()
    usingDefaultBehaviour()
}
</code></pre>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../configuration/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Configuration guide" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Configuration guide
            </div>
          </div>
        </a>
      
      
        
        <a href="../security/" class="md-footer__link md-footer__link--next" aria-label="Next: Security" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Security
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.fcfe8b6d.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.b1047164.min.js"></script>
      
    
  </body>
</html>